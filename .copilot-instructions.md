# Instructions for AI Assistants

## Version Management - CRITICAL

**DO NOT manually bump versions in these files:**
- `porpoise-ui/package.json`
- `Porpoise.Api/Porpoise.Api.csproj`
- `VERSION.md`

**Why:** CI/CD automatically bumps versions on every push to develop. Manual version changes create merge conflicts.

**Workflow:**
1. Make code changes
2. Commit without touching version files
3. Push to develop → CI/CD auto-bumps version
4. Merge develop to main (CI/CD handles versioning)

## Git Workflow

**Standard commit flow:**
```bash
git pull origin develop  # ALWAYS pull first - CI/CD may have bumped version
git add [files]
git commit -m "message"
git push origin develop
git fetch origin --tags --force  # Sync tags to avoid VS Code "overwrite" warnings
```

**If push is rejected (branch behind remote):**
This happens when CI/CD auto-bumped the version between your pull and push.

```bash
git pull --rebase origin develop  # Pull and rebase your commit on top
git push origin develop
git fetch origin --tags --force  # Always sync tags after push
```

**Why rebase?** CI/CD commits are simple version bumps. Rebasing puts your work on top of the version bump, keeping history clean.

**Why force-fetch tags?** CI/CD creates version tags. Force-fetching syncs local tags with remote to prevent VS Code "overwrite tags" warnings.

**Merge to main:**
```bash
git checkout main
git pull origin main
git merge develop --no-edit  # Use --no-edit to avoid interactive merge message
# If conflicts occur (usually VERSION.md):
git checkout --theirs VERSION.md  # Accept develop's version
git add VERSION.md
git commit --no-edit
git push origin main
git checkout develop
```

## Common Pitfalls

- ❌ Don't merge main into develop (unnecessary, creates conflicts)
- ❌ Don't manually change version numbers
- ❌ Don't commit without pulling first (CI/CD may have bumped version)
- ❌ Don't let git prompt for merge messages interactively - always use `--no-edit`
- ✅ Always work on develop branch
- ✅ Let CI/CD handle versioning
- ✅ Only merge develop → main (one direction)
- ✅ Always use `--no-edit` flag when merging to avoid interactive prompts
- ✅ For VERSION.md conflicts: use `git checkout --theirs VERSION.md` to accept develop's version
- ✅ If push rejected: use `git pull --rebase origin develop` then push again

## Development Server Management

- **DO NOT restart dev servers** - The user already has servers running (npm run dev, dotnet watch)
- Vite hot-reloads automatically for file changes
- Only suggest restarting if there's a genuine build error or dependency change

## User Preferences

- **Bedtime:** 11:00 PM - Remind user to wrap up work around this time
- **Work style:** Prefers iterative development with testing before commits
